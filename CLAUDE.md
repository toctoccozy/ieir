# IEI サイトコンバート ガイド

## コンバート

5桁の商品番号を指定すると、旧ページから新ページへコンバートを実行する。

### ファイル構成
- 旧ページ: `python/output_files/{商品番号}.txt`
- フォーマット: `format/format_01.html`(単一タイプ) / `format/format_02.html`(複数タイプ)
- 出力先: `products/{商品番号}.html`

### フォーマット判定
- 単一タイプ: `name="form_cart"` → format_01.html
- 複数タイプ: `name="form_cart1"`, `name="form_cart2"` など → format_02.html

### 変換ルール

#### トップ画像
`{商品番号}_01.jpg` を使用

#### 商品紹介文
- 旧ページの`<br>`を全て除去
- 句点(。)ごとに`<br>`を挿入

#### メイン画像・箇条書きエリア
- main_600x600画像がある場合 → パターンA使用
- main_600x600画像がない場合 → パターンB使用（_01.jpgを使用）
- `class="intro"`の内容を`<ul>`に移行
- `<span class="sq01">■</span>`は除去し、直接「■」を記述

#### 商品詳細
旧ページの順番を維持しながら以下のタグを使用:
- `<p>`: 文章（句点ごとに`<br>`挿入）
- `<img>`: 画像
- `<h2>`: 見出し
- `class="flt-1"`: 画像+テキスト横並び
- `class="box1"`: 囲み枠

#### 改行ルール詳細
- **基本ルール**: 全ての`<p>`タグ内の文章は句点(。)ごとに`<br>`を挿入
- **例外**: `box1`内の`<span>`タグ内のみ`<br>`不要
- **flt-l内**: 通常通り句点で`<br>`を入れる（長文になりやすいため）
- **長文注意**: 3行以上続く文章は必ず句点で改行されているか確認

#### 仕様
旧ページの`<dt>仕 様</dt>`に続く`<dd>`の内容を抽出し、新ページの仕様欄に反映

#### 価格・購入エリア
黒四角(■)部分は動的パラメータのためそのまま維持

### 複数タイプ(format_02)の場合

#### 仕様が商品タイプごとに異なる場合
旧ページで商品タイプ（例: 軸装・額装、黄色・黒色など）ごとに仕様が異なる場合:
- `@foreach`ループはそのまま維持（展開しない）
- 仕様欄のみ、商品番号で`@if`条件分岐して個別テキストを記述

```php
@foreach ($goods->getConnectGoods() as $connect_goods)
    ...動的部分はそのまま...
    <p class="leading-snug text-sm">
        @if ($connect_goods->getItemNo() == '商品番号1')
            【タイプAの仕様テキスト】
        @elseif ($connect_goods->getItemNo() == '商品番号2')
            【タイプBの仕様テキスト】
        @endif
    </p>
    ...動的部分はそのまま...
@endforeach
```

**注意**: `$goods->getConnectGoods()[0]`のような配列インデックスアクセスは使用しない（Undefined array keyエラーの原因）

#### 仕様が共通の場合
全商品タイプで仕様が同じ場合は、`@foreach`ループ内に仕様テキストを1箇所に記述（条件分岐不要）

### 注意事項
- 画像パスはそのまま利用
- altは該当箇所をそのまま反映
- サイズ表画像はPC版で小さめ表示
- YouTube埋め込みがある場合は適切に反映

### 変換後チェックリスト
出力前に以下を必ず確認:
- [ ] 全ての`<p>`タグ内で句点(。)ごとに`<br>`が入っているか
- [ ] 長文(3行以上)が改行なしで続いていないか
- [ ] 画像パスは正しいか（/image/goods/で始まる）
- [ ] altは旧ページから正しく反映されているか
- [ ] 仕様欄の内容は正しいか
